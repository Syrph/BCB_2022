
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Setting conservation priorities &#8212; Biodiversity and  &lt;br/&gt;Conservation Biology</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.e2363ea40746bee74734a24ffefccd78.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/blank.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/copybutton_funcs.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery-3.5.1.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/searchtools.js"></script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="../../_static/sphinx-thebe.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/underscore-1.13.1.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>
    <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Useful links" href="../../links.html" />
    <link rel="prev" title="Macroecology analyses" href="../practical_2/practical_2.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Biodiversity and  <br/>Conservation Biology</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../practical_1/practical_1.html">
   Basics &amp; Phylogenetics in R
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../practical_2/practical_2.html">
   Macroecology analyses
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Setting conservation priorities
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../links.html">
   Useful links
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/markdowns/practical_3/practical_3.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-and-resources">
   1. Introduction and resources
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preparing-data">
   2. Preparing data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ed-scores">
   3. ED Scores
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#edge-scores">
   4. EDGE Scores
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ecodge-scores">
   5. EcoDGE Scores
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ecoedge-scores">
   6. EcoEDGE Scores
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-a-map-of-iucn-categories">
   7. Plotting a map of IUCN categories
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <section id="setting-conservation-priorities">
<h1>Setting conservation priorities<a class="headerlink" href="#setting-conservation-priorities" title="Permalink to this headline">¶</a></h1>
<section id="introduction-and-resources">
<h2>1. Introduction and resources<a class="headerlink" href="#introduction-and-resources" title="Permalink to this headline">¶</a></h2>
<p>This practical is aimed to introduce you to the EDGE &amp; EcoEDGE scores
that you’ll need for your conservation strategy coursework. Put briefly,
these scores balance the distinctiveness of species against their risk
of extinction to determine conservation priorities. You can find out
more information about EDGE scores from the ZSL website:</p>
<p><a class="reference external" href="https://www.zsl.org/conservation/our-priorities/wildlife-back-from-the-brink/animals-on-the-edge">https://www.zsl.org/conservation/our-priorities/wildlife-back-from-the-brink/animals-on-the-edge</a></p>
<p>We will also try plotting a simple map of IUCN categories so we can
visual the risk to our clade across the globe.</p>
</section>
<section id="preparing-data">
<h2>2. Preparing data<a class="headerlink" href="#preparing-data" title="Permalink to this headline">¶</a></h2>
<p>To calculate EDGE metrics, we need data on the species we’re interested
in, and their phylogenetic relationship. For the coursework we’re
interested in EDGE scores for a specific clade, however it’s also common
to look at areas such as national parks.</p>
<p>For this practical we’re going to use the same family as Practical 2,
Accipitridae. We’ll use the same table of traits from Practical 2 to
import our data and filter it.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in the avonet data again.</span>
<span class="n">trait_data</span> <span class="o">&lt;-</span> <span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;data/avonet_data.csv&quot;</span><span class="p">)</span>
<span class="nf">str</span><span class="p">(</span><span class="n">trait_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>## &#39;data.frame&#39;:    9872 obs. of  26 variables:
##  $ birdlife_name       : chr  &quot;Accipiter albogularis&quot; &quot;Accipiter badius&quot; &quot;Accipiter bicolor&quot; &quot;Accipiter brachyurus&quot; ...
##  $ birdlife_common_name: chr  &quot;Pied Goshawk&quot; &quot;Shikra&quot; &quot;Bicolored Hawk&quot; &quot;New Britain Sparrowhawk&quot; ...
##  $ jetz_name           : chr  &quot;Accipiter_albogularis&quot; &quot;Accipiter_badius&quot; &quot;Accipiter_bicolor&quot; &quot;Accipiter_brachyurus&quot; ...
##  $ jetz_order          : chr  &quot;Accipitriformes&quot; &quot;Accipitriformes&quot; &quot;Accipitriformes&quot; &quot;Accipitriformes&quot; ...
##  $ jetz_family         : chr  &quot;Accipitridae&quot; &quot;Accipitridae&quot; &quot;Accipitridae&quot; &quot;Accipitridae&quot; ...
##  $ redlist_cat         : chr  &quot;LC&quot; &quot;LC&quot; &quot;LC&quot; &quot;VU&quot; ...
##  $ extinct_prob        : num  0.0606 0.0606 0.0606 0.2425 0.0606 ...
##  $ beak_length_culmen  : num  27.7 20.6 25 22.5 21.1 20 20.5 19.2 20 25.4 ...
##  $ beak_length_nares   : num  17.8 12.1 13.7 14 12.1 11.9 11.5 10.6 11.2 13.9 ...
##  $ beak_width          : num  10.6 8.8 8.6 8.9 8.7 6.6 8.3 7.7 8.6 8.6 ...
##  $ beak_depth          : num  14.7 11.6 12.7 11.9 11.1 12 10.9 9.6 11 13.2 ...
##  $ tarsus_length       : num  62 43 58.1 61.2 46.4 48.7 52.6 60.3 43.6 62 ...
##  $ wing_length         : num  235 187 230 202 218 ...
##  $ kipps_distance      : num  81.8 62.5 56.6 64.1 87.8 42.9 38.9 81.3 49.5 77.8 ...
##  $ secondary1          : num  160 127 175 138 130 ...
##  $ hand_wing_index     : num  33.9 32.9 24.6 31.7 40.2 25.8 24 37.8 30 32.3 ...
##  $ tail_length         : num  169 141 186 141 154 ...
##  $ mass                : num  249 131 288 142 186 ...
##  $ habitat_density     : int  1 2 2 1 1 1 1 1 1 2 ...
##  $ migration           : int  2 3 2 2 3 1 2 2 2 3 ...
##  $ trophic_level       : chr  &quot;Carnivore&quot; &quot;Carnivore&quot; &quot;Carnivore&quot; &quot;Carnivore&quot; ...
##  $ trophic_niche       : chr  &quot;Vertivore&quot; &quot;Vertivore&quot; &quot;Vertivore&quot; &quot;Vertivore&quot; ...
##  $ primary_lifestyle   : chr  &quot;Insessorial&quot; &quot;Insessorial&quot; &quot;Generalist&quot; &quot;Insessorial&quot; ...
##  $ centroid_latitude   : num  -8.15 8.23 -10.1 -5.45 45.24 ...
##  $ centroid_longitude  : num  158.5 45 -60 150.7 45.3 ...
##  $ range_size          : num  37461 22374973 14309701 35581 2936752 ...
</pre></div>
</div>
<p>And again filter for Accipitridae.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load dplyr so we can filter.</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<span class="n">accip_data</span> <span class="o">&lt;-</span> <span class="n">trait_data</span> <span class="o">%&gt;%</span> <span class="nf">filter</span><span class="p">(</span><span class="n">jetz_family</span> <span class="o">==</span> <span class="s">&quot;Accipitridae&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Because we’re going to use EDGE scores, we should check for any extinct
species we need to remove.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># This operator | means OR. EW means extinct in the wild.</span>
<span class="n">accip_data</span> <span class="o">%&gt;%</span> <span class="nf">filter</span><span class="p">(</span><span class="n">redlist_cat</span> <span class="o">==</span> <span class="s">&quot;EX&quot;</span> <span class="o">|</span> <span class="n">redlist_cat</span> <span class="o">==</span> <span class="s">&quot;EW&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>##  [1] birdlife_name        birdlife_common_name jetz_name            jetz_order           jetz_family         
##  [6] redlist_cat          extinct_prob         beak_length_culmen   beak_length_nares    beak_width          
## [11] beak_depth           tarsus_length        wing_length          kipps_distance       secondary1          
## [16] hand_wing_index      tail_length          mass                 habitat_density      migration           
## [21] trophic_level        trophic_niche        primary_lifestyle    centroid_latitude    centroid_longitude  
## [26] range_size          
## &lt;0 rows&gt; (or 0-length row.names)
</pre></div>
</div>
<p>Great, no extinct species in this family! There shouldn’t really be many
in our Jetz phylogeny, but some do turn up occasionally.</p>
<p>Now we need to load in our tree. For this practical we’re using a random
tree extracted from <a class="reference external" href="http://birdtree.org/">http://birdtree.org/</a></p>
<p>Because we’re not sure on the exact placement of some species tips, the
Jetz tree has multiple versions, each with a slightly different layout.
Normally this only means a few species have swapped places slightly.
This is why we’ve chosen a random tree for our analysis. There are other
methods for dealing with this uncertainty, but for these practicals it
will be enough to use a random tree.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load phylogenetic packages.</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ape</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">caper</span><span class="p">)</span>

<span class="c1"># Load in and plot the tree.</span>
<span class="n">bird_tree</span> <span class="o">&lt;-</span> <span class="nf">read.tree</span><span class="p">(</span><span class="s">&quot;data/all_birds.tre&quot;</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">bird_tree</span><span class="p">,</span> <span class="n">cex</span><span class="o">=</span><span class="m">0.01</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/unnamed-chunk-4-11.png"><img alt="../../_images/unnamed-chunk-4-11.png" class="align-center" src="../../_images/unnamed-chunk-4-11.png" style="width: 600px;" /></a>
<p>There’s a lot of tips so that’s a pretty ugly tree! We can remove the
species as we did before. See if you can do it yourself first using
drop.tips again.</p>
<div class="dropdown admonition">
<p class="admonition-title">Show the answer…  </p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the tips we don&#39;t want.</span>
<span class="n">drop_tips</span> <span class="o">&lt;-</span> <span class="nf">setdiff</span><span class="p">(</span><span class="n">bird_tree</span><span class="o">$</span><span class="n">tip.label</span><span class="p">,</span> <span class="n">accip_data</span><span class="o">$</span><span class="n">jetz_name</span><span class="p">)</span>

<span class="c1"># Drop the tips.</span>
<span class="n">bird_tree</span> <span class="o">&lt;-</span> <span class="nf">drop.tip</span><span class="p">(</span><span class="n">bird_tree</span><span class="p">,</span> <span class="n">drop_tips</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="ed-scores">
<h2>3. ED Scores<a class="headerlink" href="#ed-scores" title="Permalink to this headline">¶</a></h2>
<p>Now that we’ve got our tree and our species we can start calculating our
ED (Evolutionary Distinctiveness) scores. Then we can figure out if
specific Accipitridae species are closely related to others in the tree,
or represent distinct lineages that might want to conserve to protect
valuable evolutionary diversity.</p>
<p>We can do this easily using a simple function from the <code class="docutils literal notranslate"><span class="pre">caper</span></code> package.
This sometimes takes a while to run.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># We first transform our tree into a matrix of distances from each tip to tip. </span>
<span class="c1"># This step is optional but stops a warning from ed.calc, which prefers a matrix.</span>
<span class="n">bird_matrix</span> <span class="o">&lt;-</span> <span class="nf">clade.matrix</span><span class="p">(</span><span class="n">bird_tree</span><span class="p">)</span>

<span class="c1"># Now we can run the ed.calc function, which calculates ED scores for each species. </span>
<span class="c1"># The output gives two dataframes, but we only want the species names and scores so we use $spp</span>
<span class="n">ED</span> <span class="o">&lt;-</span> <span class="nf">ed.calc</span><span class="p">(</span><span class="n">bird_matrix</span><span class="p">)</span><span class="o">$</span><span class="n">spp</span>
<span class="nf">head</span><span class="p">(</span><span class="n">ED</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>##                 species       ED
## 1      Elanus_caeruleus 18.33354
## 2      Elanus_axillaris 18.33354
## 3       Elanus_leucurus 21.04545
## 4       Elanus_scriptus 21.04545
## 5 Chelictinia_riocourii 26.70163
## 6  Gampsonyx_swainsonii 26.70163
</pre></div>
</div>
<p>Now that we’ve got our ED scores for each species, we need to log
transform and normalise our scores.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># By adding 1 to our scores, this prevents negative logs when our ED scores are below 1.</span>
<span class="n">ED</span><span class="o">$</span><span class="n">EDlog</span> <span class="o">&lt;-</span> <span class="nf">log</span><span class="p">(</span><span class="m">1</span><span class="o">+</span><span class="n">ED</span><span class="o">$</span><span class="n">ED</span><span class="p">)</span>

<span class="c1"># We can normalise our scores so they&#39;re scaled between 0 and 1.</span>
<span class="n">ED</span><span class="o">$</span><span class="n">EDn</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="n">ED</span><span class="o">$</span><span class="n">EDlog</span> <span class="o">-</span> <span class="nf">min</span><span class="p">(</span><span class="n">ED</span><span class="o">$</span><span class="n">EDlog</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">ED</span><span class="o">$</span><span class="n">EDlog</span><span class="p">)</span> <span class="o">-</span> <span class="nf">min</span><span class="p">(</span><span class="n">ED</span><span class="o">$</span><span class="n">EDlog</span><span class="p">))</span>
<span class="nf">head</span><span class="p">(</span><span class="n">ED</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>##                 species       ED    EDlog       EDn
## 1      Elanus_caeruleus 18.33354 2.961842 0.8512172
## 2      Elanus_axillaris 18.33354 2.961842 0.8512172
## 3       Elanus_leucurus 21.04545 3.093106 0.9055199
## 4       Elanus_scriptus 21.04545 3.093106 0.9055199
## 5 Chelictinia_riocourii 26.70163 3.321491 1.0000000
## 6  Gampsonyx_swainsonii 26.70163 3.321491 1.0000000
</pre></div>
</div>
<p>Now that we have our normalised scores for all birds, we need to subset
the list for just Accipitridae.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pull out the ED row numbers for our species list.</span>
<span class="n">accip_ED</span> <span class="o">&lt;-</span> <span class="n">ED</span> <span class="o">%&gt;%</span> <span class="nf">filter</span><span class="p">(</span><span class="n">species</span> <span class="o">%in%</span> <span class="n">accip_data</span><span class="o">$</span><span class="n">jetz_name</span><span class="p">)</span>
<span class="nf">str</span><span class="p">(</span><span class="n">accip_ED</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>## &#39;data.frame&#39;:    237 obs. of  4 variables:
##  $ species: chr  &quot;Elanus_caeruleus&quot; &quot;Elanus_axillaris&quot; &quot;Elanus_leucurus&quot; &quot;Elanus_scriptus&quot; ...
##  $ ED     : num  18.3 18.3 21 21 26.7 ...
##  $ EDlog  : num  2.96 2.96 3.09 3.09 3.32 ...
##  $ EDn    : num  0.851 0.851 0.906 0.906 1 ...
</pre></div>
</div>
<p>We now have the ED scores of 237 species in Accipitridae. With these
scores we can see how unique our species are in terms of the
evolutionary pathway.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find the highest ED score.</span>
<span class="n">accip_ED</span><span class="p">[</span><span class="n">accip_ED</span><span class="o">$</span><span class="n">EDn</span> <span class="o">==</span> <span class="nf">max</span><span class="p">(</span><span class="n">accip_ED</span><span class="o">$</span><span class="n">EDn</span><span class="p">),]</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>##                 species       ED    EDlog EDn
## 5 Chelictinia_riocourii 26.70163 3.321491   1
## 6  Gampsonyx_swainsonii 26.70163 3.321491   1
</pre></div>
</div>
<p>The highest ED scores belong to <em>Chelictinia riocourii</em>, the
scissor-tailed kite, and <em>Gampsonyx swainsonii</em>, the pearl kite. Both
species are the only member of a monotypic genus, and part of the small
subfamily Elaninae, the elanine kites. This subfamily only has six
species, and all the others form one genus. Therefore, with so few close
relatives, we might consider this species a conservation priority to
protect as much diversity as we can. However we don’t yet know if this
species needs conserving…</p>
</section>
<section id="edge-scores">
<h2>4. EDGE Scores<a class="headerlink" href="#edge-scores" title="Permalink to this headline">¶</a></h2>
<p>This is where EDGE scores come in. By combining ED scores with IUCN
categories we can select the species that need conservation action, and
represent unique evolutionary variation.</p>
<p>Each IUCN category has an extinction probability used to calculate EDGE
scores. This is based on a recent paper that’s refined the methodology.
These extinction probabilities are also referred to as GE (Globally
Endangered) scores, which is why it’s called EDGE.</p>
<p>We’ll add the ED scores to the main dataset first, and then we can
easily calculate EDGE.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Join the last two columns of UK_Jetz to ED scores. </span>
<span class="c1"># This time we&#39;ll use the &#39;by&#39; argument rather than change the column names.</span>
<span class="n">accip_EDGE</span> <span class="o">&lt;-</span> <span class="nf">left_join</span><span class="p">(</span><span class="n">accip_data</span><span class="p">,</span> <span class="n">accip_ED</span><span class="p">,</span>  <span class="n">by</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;jetz_name&quot;</span> <span class="o">=</span> <span class="s">&quot;species&quot;</span><span class="p">))</span>

<span class="c1"># Head but we&#39;ll view just the first and last few columns.</span>
<span class="nf">head</span><span class="p">(</span><span class="n">accip_EDGE</span><span class="p">)[,</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="o">:</span><span class="m">3</span><span class="p">,</span> <span class="m">26</span><span class="o">:</span><span class="m">29</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>##      birdlife_common_name             jetz_name  range_size        ED    EDlog       EDn
## 1            Pied Goshawk Accipiter_albogularis    37461.21  8.156562 2.214471 0.5420387
## 2                  Shikra      Accipiter_badius 22374973.00  5.481852 1.869006 0.3991241
## 3          Bicolored Hawk     Accipiter_bicolor 14309701.27  8.097777 2.208030 0.5393742
## 4 New Britain Sparrowhawk  Accipiter_brachyurus    35580.71 10.813851 2.469273 0.6474472
## 5      Levant Sparrowhawk    Accipiter_brevipes  2936751.80  5.643636 1.893659 0.4093228
## 6     Nicobar Sparrowhawk     Accipiter_butleri      327.84 11.220553 2.503119 0.6614491
</pre></div>
</div>
<p>We can now calculate our EDGE scores using some simple maths:</p>
<div class="math notranslate nohighlight">
\[EDGE=ln⁡(1+ED)+GE×ln⁡(2)\]</div>
<p>We have already done the first half. Now we just need to multiply GE
scores by the natural log of 2, and combine them.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># The log function uses natural logarithms by default.</span>
<span class="n">accip_EDGE</span><span class="o">$</span><span class="n">EDGE</span> <span class="o">&lt;-</span> <span class="n">accip_EDGE</span><span class="o">$</span><span class="n">EDlog</span> <span class="o">+</span> <span class="n">accip_EDGE</span><span class="o">$</span><span class="n">extinct_prob</span> <span class="o">*</span> <span class="nf">log</span><span class="p">(</span><span class="m">2</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">accip_EDGE</span><span class="p">)[,</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="o">:</span><span class="m">3</span><span class="p">,</span> <span class="m">26</span><span class="o">:</span><span class="m">30</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>##      birdlife_common_name             jetz_name  range_size        ED    EDlog       EDn     EDGE
## 1            Pied Goshawk Accipiter_albogularis    37461.21  8.156562 2.214471 0.5420387 2.256493
## 2                  Shikra      Accipiter_badius 22374973.00  5.481852 1.869006 0.3991241 1.911028
## 3          Bicolored Hawk     Accipiter_bicolor 14309701.27  8.097777 2.208030 0.5393742 2.250052
## 4 New Britain Sparrowhawk  Accipiter_brachyurus    35580.71 10.813851 2.469273 0.6474472 2.637361
## 5      Levant Sparrowhawk    Accipiter_brevipes  2936751.80  5.643636 1.893659 0.4093228 1.935681
## 6     Nicobar Sparrowhawk     Accipiter_butleri      327.84 11.220553 2.503119 0.6614491 2.671207
</pre></div>
</div>
<p>Now we have our EDGE scores, we can see if our conservation priority has
changed in light of IUCN categories.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find the highest EDGE score.</span>
<span class="n">accip_EDGE</span><span class="p">[</span><span class="n">accip_EDGE</span><span class="o">$</span><span class="n">EDGE</span> <span class="o">==</span> <span class="nf">max</span><span class="p">(</span><span class="n">accip_EDGE</span><span class="o">$</span><span class="n">EDGE</span><span class="p">),</span> <span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="o">:</span><span class="m">3</span><span class="p">,</span> <span class="m">26</span><span class="o">:</span><span class="m">30</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>##     birdlife_common_name             jetz_name range_size       ED    EDlog       EDn    EDGE
## 217     Philippine Eagle Pithecophaga_jefferyi   142256.5 22.13085 3.141167 0.9254021 3.81352
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find the EDGE score for our previous highest species.</span>
<span class="n">accip_EDGE</span><span class="p">[</span><span class="n">accip_EDGE</span><span class="o">$</span><span class="n">EDn</span> <span class="o">==</span> <span class="nf">max</span><span class="p">(</span><span class="n">accip_EDGE</span><span class="o">$</span><span class="n">EDn</span><span class="p">),</span> <span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="o">:</span><span class="m">3</span><span class="p">,</span> <span class="m">26</span><span class="o">:</span><span class="m">30</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>##     birdlife_common_name             jetz_name range_size       ED    EDlog EDn     EDGE
## 103  Scissor-tailed Kite Chelictinia_riocourii    5425286 26.70163 3.321491   1 3.363513
## 135           Pearl Kite  Gampsonyx_swainsonii   10266135 26.70163 3.321491   1 3.363513
</pre></div>
</div>
<p>So now we can see that the top conservation priority is the Philippine
Eagle, <em>Pithecophaga jefferyi</em>. Whilst our previous kites are still
high, their low IUCN score means its less of a priority than P.
jefferyi, which is critically endangered.</p>
<p>In reality, you want to preserve more than just one species! We can see
from the spread of EDGE scores that there are few species with high EDGE
scores, and we would ideally like to create a plan that maximises the
conservation of all of them (if it’s possible). Based on your own taxa
you’ll decide what constitutes a high EDGE score.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot a histogram of EDGE values.</span>
<span class="nf">hist</span><span class="p">(</span><span class="n">accip_EDGE</span><span class="o">$</span><span class="n">EDGE</span><span class="p">,</span> <span class="n">breaks</span> <span class="o">=</span> <span class="m">20</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/unnamed-chunk-14-1.png"><img alt="../../_images/unnamed-chunk-14-1.png" class="align-center" src="../../_images/unnamed-chunk-14-1.png" style="width: 600px;" /></a>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># WE can use the select function to pull out only the columns we want to view.</span>
<span class="c1"># Because there&#39;s another function called select, we specify it&#39;s from dplyr.</span>
<span class="n">accip_EDGE</span> <span class="o">%&gt;%</span> <span class="nf">filter</span><span class="p">(</span><span class="n">EDGE</span> <span class="o">&gt;</span> <span class="m">3</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="n">dplyr</span><span class="o">::</span><span class="nf">select</span><span class="p">(</span><span class="n">birdlife_common_name</span><span class="p">,</span> <span class="n">jetz_name</span><span class="p">,</span> <span class="n">redlist_cat</span><span class="p">,</span> <span class="n">EDGE</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>##        birdlife_common_name               jetz_name redlist_cat     EDGE
## 1       Scissor-tailed Kite   Chelictinia_riocourii          LC 3.363513
## 2                Cuban Kite  Chondrohierax_wilsonii          CR 3.126552
## 3       Swallow-tailed Kite    Elanoides_forficatus          LC 3.337099
## 4     Black-shouldered Kite        Elanus_axillaris          LC 3.003864
## 5         Black-winged Kite        Elanus_caeruleus          LC 3.003864
## 6         White-tailed Kite         Elanus_leucurus          LC 3.135128
## 7        Letter-winged Kite         Elanus_scriptus          NT 3.177150
## 8  Madagascar Serpent-eagle       Eutriorchis_astur          EN 3.609771
## 9                Pearl Kite    Gampsonyx_swainsonii          LC 3.363513
## 10          Bearded Vulture       Gypaetus_barbatus          NT 3.273313
## 11         Palm-nut Vulture   Gypohierax_angolensis          LC 3.338387
## 12              Harpy Eagle          Harpia_harpyja          NT 3.208049
## 13             Papuan Eagle Harpyopsis_novaeguineae          VU 3.400970
## 14                 Bat Hawk   Macheiramphus_alcinus          LC 3.297136
## 15            Gabar Goshawk          Melierax_gabar          LC 3.010849
## 16            Crested Eagle     Morphnus_guianensis          NT 3.208049
## 17           Hooded Vulture    Necrosyrtes_monachus          CR 3.287320
## 18         Egyptian Vulture   Neophron_percnopterus          EN 3.525445
## 19         Philippine Eagle   Pithecophaga_jefferyi          CR 3.813520
## 20       Red-headed Vulture        Sarcogyps_calvus          CR 3.284243
## 21                 Bateleur   Terathopius_ecaudatus          NT 3.177064
## 22     White-headed Vulture Trigonoceps_occipitalis          CR 3.045750
## 23         Long-tailed Hawk  Urotriorchis_macrourus          LC 3.017105
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In the above code we used the pipe operator <code class="docutils literal notranslate"><span class="pre">%&gt;%</span></code> twice! This is why it’s called a pipe.
We can get the end product of each function to “flow” down to the next, like water
down a pipe!</p>
</div>
</section>
<section id="ecodge-scores">
<h2>5. EcoDGE Scores<a class="headerlink" href="#ecodge-scores" title="Permalink to this headline">¶</a></h2>
<p>Instead of evolutionary distinctiveness, we might instead be interested
in what functions each species provides the ecosystem. Species with low
functional diversity may be ‘functionally redundant’ in the ecosystem,
whereas those with high functional diversity may provide key ecosystem
services that aren’t easily replaceable. We call these scores EcoDGE
scores, with “eco” short for ecologically diverse.</p>
<p>Like ED, we will calculate functional distinctiveness (FD and FDn) in
relation to all other accipitridae species. The reason for this is that
FD is traditionally used in the context of a specific community or
radiation of species (i.e. all birds found within a national park, or
all species of lemur).</p>
<p>To calculate the function of species, we’ll use their morphological
traits. Recent research has shown that a few simple traits can predict
the niche a species occupies, which in turn tells us about function. For
instance, frugivores provide vital seed dispersal, and insectivores
influence invertebrate population dynamics.</p>
<p><a class="reference external" href="https://www.nature.com/articles/s41559-019-1070-4">https://www.nature.com/articles/s41559-019-1070-4</a></p>
<p>We’ll use just a few key traits, separated into beak shape (primarily
trophic), and body shape (primarily locomotion). We can also include
body mass.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Split the traits into beak shape traits, body shape traits, and body mass.</span>
<span class="n">beak_traits</span> <span class="o">&lt;-</span> <span class="n">accip_data</span> <span class="o">%&gt;%</span> <span class="n">dplyr</span><span class="o">::</span><span class="nf">select</span><span class="p">(</span><span class="n">beak_length_culmen</span><span class="p">,</span> <span class="n">beak_width</span><span class="p">,</span> <span class="n">beak_depth</span><span class="p">)</span>
<span class="n">body_traits</span> <span class="o">&lt;-</span> <span class="n">accip_data</span> <span class="o">%&gt;%</span> <span class="n">dplyr</span><span class="o">::</span><span class="nf">select</span><span class="p">(</span><span class="n">tarsus_length</span><span class="p">,</span> <span class="n">wing_length</span><span class="p">,</span> <span class="n">tail_length</span><span class="p">)</span>
<span class="n">body_mass</span> <span class="o">&lt;-</span> <span class="nf">log</span><span class="p">(</span><span class="n">accip_data</span><span class="o">$</span><span class="n">mass</span><span class="p">)</span>

<span class="c1"># Look at the correlations between traits, including body mass.</span>
<span class="nf">pairs</span><span class="p">(</span><span class="nf">cbind</span><span class="p">(</span><span class="n">beak_traits</span><span class="p">,</span> <span class="n">body_mass</span><span class="p">))</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/unnamed-chunk-17-1.png"><img alt="../../_images/unnamed-chunk-17-1.png" class="align-center" src="../../_images/unnamed-chunk-17-1.png" style="width: 600px;" /></a>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">pairs</span><span class="p">(</span><span class="nf">cbind</span><span class="p">(</span><span class="n">body_traits</span><span class="p">,</span> <span class="n">body_mass</span><span class="p">))</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/unnamed-chunk-17-2.png"><img alt="../../_images/unnamed-chunk-17-2.png" class="align-center" src="../../_images/unnamed-chunk-17-2.png" style="width: 600px;" /></a>
<p>So we can see some pretty strong correlations between beak shape, body
shape and body mass. This is because bigger species tend to have
proportionally bigger traits. If we were to calculate functional
distinctiveness using these traits in their current form, we would
probably only determine which species are the biggest and smallest.
Another problem is that when all the traits are highly correlated, it’s
harder to tell which ones are important for functional distinctiveness.
Instead our model may simply pick them at random, leading to potentially
random results.</p>
<p>We can get around this by using a Principal Components Analysis (PCA).
We can condense our traits down into fewer uncorrelated variables, and
potentially remove body mass from beak and body shape measurements.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># First standardize the traits so they&#39;re all on a similar scale.</span>
<span class="n">beak_traits</span> <span class="o">&lt;-</span> <span class="nf">scale</span><span class="p">(</span><span class="n">beak_traits</span><span class="p">)</span>
<span class="n">body_traits</span> <span class="o">&lt;-</span> <span class="nf">scale</span><span class="p">(</span><span class="n">body_traits</span><span class="p">)</span>

<span class="c1"># Run a PCA of each set of traits separately.</span>
<span class="n">beak_pca</span> <span class="o">&lt;-</span> <span class="nf">princomp</span><span class="p">(</span><span class="n">beak_traits</span><span class="p">)</span>
<span class="n">body_pca</span> <span class="o">&lt;-</span> <span class="nf">princomp</span><span class="p">(</span><span class="n">body_traits</span><span class="p">)</span>

<span class="c1"># Look at the variation explained by each axes.</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">beak_pca</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>## Importance of components:
##                          Comp.1     Comp.2     Comp.3
## Standard deviation     1.686854 0.28731142 0.24355261
## Proportion of Variance 0.952511 0.02763254 0.01985641
## Cumulative Proportion  0.952511 0.98014359 1.00000000
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="n">body_pca</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>## Importance of components:
##                           Comp.1    Comp.2     Comp.3
## Standard deviation     1.5695430 0.5651380 0.45221184
## Proportion of Variance 0.8246346 0.1069114 0.06845402
## Cumulative Proportion  0.8246346 0.9315460 1.00000000
</pre></div>
</div>
<p>Running <code class="docutils literal notranslate"><span class="pre">princomp</span></code> has created a PCA object, with three now uncorrelated
axes. They are arranged in order of the variation that they explain,
with the 1st component (or axis) explaining the most. We can see this is
95% of the variation for beak traits, and 83% of the variation for body
shape traits.</p>
<p>We can look at the loadings of each PCA object to see how the original
variables contributed to each new PCA axis.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Return the loadings.</span>
<span class="nf">loadings</span><span class="p">(</span><span class="n">beak_pca</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>## 
## Loadings:
##                    Comp.1 Comp.2 Comp.3
## beak_length_culmen  0.575  0.778  0.253
## beak_width          0.580 -0.169 -0.797
## beak_depth          0.577 -0.606  0.548
## 
##                Comp.1 Comp.2 Comp.3
## SS loadings     1.000  1.000  1.000
## Proportion Var  0.333  0.333  0.333
## Cumulative Var  0.333  0.667  1.000
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">loadings</span><span class="p">(</span><span class="n">body_pca</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>## 
## Loadings:
##               Comp.1 Comp.2 Comp.3
## tarsus_length  0.567  0.753  0.334
## wing_length    0.592        -0.801
## tail_length    0.573 -0.652  0.496
## 
##                Comp.1 Comp.2 Comp.3
## SS loadings     1.000  1.000  1.000
## Proportion Var  0.333  0.333  0.333
## Cumulative Var  0.333  0.667  1.000
</pre></div>
</div>
<p>We can see that for the first component, all three traits are positively
correlated at roughly equal amount. So species with a longer, wider and
deeper beak have a higher comp 1 value. The same is true for body shape.
So our first component most likely maps onto body size. We can test this
by plotting them together.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot PC1 against mass.</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">beak_pca</span><span class="o">$</span><span class="n">scores</span><span class="p">[,</span><span class="m">1</span><span class="p">]</span> <span class="o">~</span> <span class="nf">log</span><span class="p">(</span><span class="n">accip_data</span><span class="o">$</span><span class="n">mass</span><span class="p">))</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">body_pca</span><span class="o">$</span><span class="n">scores</span><span class="p">[,</span><span class="m">1</span><span class="p">]</span> <span class="o">~</span> <span class="nf">log</span><span class="p">(</span><span class="n">accip_data</span><span class="o">$</span><span class="n">mass</span><span class="p">))</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/unnamed-chunk-20-11.png"><img alt="../../_images/unnamed-chunk-20-11.png" class="align-center" src="../../_images/unnamed-chunk-20-11.png" style="width: 600px;" /></a>
<p>Looking at the 2nd component (PC2), we can see from the loadings that it
describes different shapes. In beak we can see a strong positive
correlation with beak length, and negative correlations with width and
depth. So species with a high PC2 tend to have long narrow beaks, rather
than short fat ones. For body shape, PC2 describes the ratio of tail to
tarsus length. So species with a low PC2 will have shorter legs and are
more agile hunters.</p>
<p>Both PC2 axes describe aspects of morphology that tell us about the
species function better than just total size. We can now use this
information to determine the functional diversity of accipitridae.</p>
<p>To calculate functional diversity we’ll create a distance matrix of our
traits. Species with similar traits will have smaller ‘distances’.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a matrix. Add in the rownames for the species.</span>
<span class="n">traits_matrix</span> <span class="o">&lt;-</span> <span class="nf">cbind</span><span class="p">(</span><span class="n">beak_pca</span><span class="o">$</span><span class="n">scores</span><span class="p">[,</span><span class="m">2</span><span class="p">],</span> <span class="n">body_pca</span><span class="o">$</span><span class="n">scores</span><span class="p">[,</span><span class="m">2</span><span class="p">],</span> <span class="nf">scale</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">accip_data</span><span class="o">$</span><span class="n">mass</span><span class="p">)))</span>
<span class="nf">rownames</span><span class="p">(</span><span class="n">traits_matrix</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="n">accip_data</span><span class="o">$</span><span class="n">jetz_name</span>

<span class="c1"># Converts traits into &#39;distance&#39; in trait space.</span>
<span class="n">distance_matrix</span> <span class="o">&lt;-</span> <span class="nf">dist</span><span class="p">(</span><span class="n">traits_matrix</span><span class="p">)</span>
</pre></div>
</div>
<p>The next step is to create a new tree using the neighbour-joining method
(Saitou &amp; Nei, 1987) (Google for more information!). This will create a
tree where branch lengths show how similar species are in trait space
rather than evolutionary distance. This function may take a while with
more species so don’t be alarmed if the group you’ve chosen takes much
longer.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create the tree.</span>
<span class="n">trait_tree</span> <span class="o">&lt;-</span> <span class="nf">nj</span><span class="p">(</span><span class="n">distance_matrix</span><span class="p">)</span>

<span class="c1"># Test to see if it&#39;s worked. The tree looks different to a normal one because tips </span>
<span class="c1"># don&#39;t line up neatly at the present time period like with evolutionary relationships.</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">trait_tree</span><span class="p">,</span> <span class="n">cex</span><span class="o">=</span><span class="m">0.4</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/unnamed-chunk-22-1.png"><img alt="../../_images/unnamed-chunk-22-1.png" class="align-center" src="../../_images/unnamed-chunk-22-1.png" style="width: 600px;" /></a>
<p>FD trees can fail if there are too many NAs in the data. If this is the
case for your taxa, remove species or traits with high NA counts from FD
analysis. Note, however, that the bird data is very complete so there
should be no need to remove NA species from the dataset; this should be
a last resort so only do this if the analyses are failing repeatedly.</p>
<p>With our tree of functional space, we can now calculate FD scores the
same way we calculated ED scores.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a matrix of distance from tip to tip.</span>
<span class="n">tree_matrix</span> <span class="o">&lt;-</span> <span class="nf">clade.matrix</span><span class="p">(</span><span class="n">trait_tree</span><span class="p">)</span>

<span class="c1"># Calculate FD scores.</span>
<span class="n">FD</span> <span class="o">&lt;-</span> <span class="nf">ed.calc</span><span class="p">(</span><span class="n">tree_matrix</span><span class="p">)</span><span class="o">$</span><span class="n">spp</span>

<span class="c1"># Change the name to FD.</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">FD</span><span class="p">)[</span><span class="m">2</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="s">&quot;FD&quot;</span>
<span class="nf">head</span><span class="p">(</span><span class="n">FD</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>##                 species         FD
## 1 Accipiter_albogularis 0.05800192
## 2      Accipiter_badius 0.37108714
## 3     Accipiter_bicolor 0.14229400
## 4  Accipiter_brachyurus 0.20783017
## 5    Accipiter_brevipes 0.11507628
## 6     Accipiter_butleri 0.11277599
</pre></div>
</div>
<p>Log and normalise the data as we did before with ED so we could compare
FD scores from different groups.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the scores again.</span>
<span class="n">FD</span><span class="o">$</span><span class="n">FDlog</span> <span class="o">&lt;-</span> <span class="nf">log</span><span class="p">(</span><span class="m">1</span><span class="o">+</span><span class="n">FD</span><span class="o">$</span><span class="n">FD</span><span class="p">)</span>
<span class="n">FD</span><span class="o">$</span><span class="n">FDn</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="n">FD</span><span class="o">$</span><span class="n">FDlog</span> <span class="o">-</span> <span class="nf">min</span><span class="p">(</span><span class="n">FD</span><span class="o">$</span><span class="n">FDlog</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">FD</span><span class="o">$</span><span class="n">FDlog</span><span class="p">)</span> <span class="o">-</span> <span class="nf">min</span><span class="p">(</span><span class="n">FD</span><span class="o">$</span><span class="n">FDlog</span><span class="p">))</span>

<span class="c1"># Find the highest FD score.</span>
<span class="n">FD</span><span class="p">[</span><span class="n">FD</span><span class="o">$</span><span class="n">FDn</span> <span class="o">==</span> <span class="nf">max</span><span class="p">(</span><span class="n">FD</span><span class="o">$</span><span class="n">FDn</span><span class="p">),]</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>##               species       FD     FDlog FDn
## 138 Gypaetus_barbatus 1.002616 0.6944545   1
</pre></div>
</div>
<p>So the species with the largest FD score is <em>Gypaetus barbatus</em>, the
Bearded Vulture. This means <em>G. barbatus</em> is the most ecologically
diverse species in our clade, based on the morphological values we’ve
supplied. You might be interested to know that <em>G. barbatus</em> is a very
unique vulture, with long narrow wings, and wedge shaped tail that makes
it unmistakable in flight! Moreover, they live on a diet of up to 90%
bone marrow, which makes them the only living bird that specialises on
marrow! This will be reflected in the beak morphological traits we used
to calculate FD. Pretty cool right!</p>
<p>We can also look at the top 5% of functionally diverse species.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the top 5% of FD scores.</span>
<span class="n">FD</span><span class="p">[</span><span class="n">FD</span><span class="o">$</span><span class="n">FD</span> <span class="o">&gt;</span> <span class="nf">quantile</span><span class="p">(</span><span class="n">FD</span><span class="o">$</span><span class="n">FD</span><span class="p">,</span> <span class="m">0.95</span><span class="p">),]</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>##                   species        FD     FDlog       FDn
## 63        Aviceda_jerdoni 0.4762142 0.3894808 0.5333437
## 103 Chelictinia_riocourii 0.8747121 0.6284551 0.8990108
## 127  Elanoides_forficatus 0.5672809 0.4493422 0.6249407
## 138     Gypaetus_barbatus 1.0026164 0.6944545 1.0000000
## 144     Gyps_himalayensis 0.5021673 0.4069089 0.5600113
## 152  Haliaeetus_pelagicus 0.6861835 0.5224677 0.7368338
## 161        Harpia_harpyja 0.5683062 0.4499962 0.6259414
## 201         Milvus_milvus 0.5158533 0.4159785 0.5738892
## 203  Necrosyrtes_monachus 0.4933096 0.4009949 0.5509619
## 204 Neophron_percnopterus 0.6344264 0.4912919 0.6891302
## 216   Pernis_ptilorhyncus 0.6033874 0.4721185 0.6597920
## 235   Torgos_tracheliotos 0.5292324 0.4247659 0.5873352
</pre></div>
</div>
<p>So these are the most functionally diverse species in our dataset, each
providing an ecosystem role that is not easily replaceable. However,
most of these species don’t currently face high extinction risk. We
should therefore combine GE scores to see how IUCN categories change our
priorities. We use the same formula as before:</p>
<div class="math notranslate nohighlight">
\[ecoDGE=ln⁡(1+FD)+GE×ln⁡(2)\]</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Join FD and GE scores.</span>
<span class="n">accip_ecoDGE</span> <span class="o">&lt;-</span> <span class="nf">left_join</span><span class="p">(</span><span class="n">accip_data</span><span class="p">,</span> <span class="n">FD</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;jetz_name&quot;</span> <span class="o">=</span> <span class="s">&quot;species&quot;</span><span class="p">))</span>

<span class="c1"># Calculate ecoDGE scores.</span>
<span class="n">accip_ecoDGE</span><span class="o">$</span><span class="n">ecoDGE</span> <span class="o">&lt;-</span> <span class="n">accip_ecoDGE</span><span class="o">$</span><span class="n">FDlog</span> <span class="o">+</span> <span class="n">accip_ecoDGE</span><span class="o">$</span><span class="n">extinct_prob</span> <span class="o">*</span> <span class="nf">log</span><span class="p">(</span><span class="m">2</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">accip_ecoDGE</span><span class="p">)[,</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="o">:</span><span class="m">3</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="m">27</span><span class="o">:</span><span class="m">30</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>##      birdlife_common_name             jetz_name redlist_cat         FD      FDlog        FDn     ecoDGE
## 1            Pied Goshawk Accipiter_albogularis          LC 0.05800192 0.05638214 0.02365179 0.09840419
## 2                  Shikra      Accipiter_badius          LC 0.37108714 0.31560396 0.42030075 0.35762600
## 3          Bicolored Hawk     Accipiter_bicolor          LC 0.14229400 0.13303852 0.14094775 0.17506057
## 4 New Britain Sparrowhawk  Accipiter_brachyurus          VU 0.20783017 0.18882550 0.22631036 0.35691370
## 5      Levant Sparrowhawk    Accipiter_brevipes          LC 0.11507628 0.10892281 0.10404704 0.15094486
## 6     Nicobar Sparrowhawk     Accipiter_butleri          VU 0.11277599 0.10685779 0.10088723 0.27494598
</pre></div>
</div>
<p>And does including IUCN categories change our conservation priorities?</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find the highest ecoDGE score.</span>
<span class="n">accip_ecoDGE</span><span class="p">[</span><span class="n">accip_ecoDGE</span><span class="o">$</span><span class="n">ecoDGE</span> <span class="o">==</span> <span class="nf">max</span><span class="p">(</span><span class="n">accip_ecoDGE</span><span class="o">$</span><span class="n">ecoDGE</span><span class="p">),</span> <span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="o">:</span><span class="m">3</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="m">27</span><span class="o">:</span><span class="m">30</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>##     birdlife_common_name            jetz_name redlist_cat        FD     FDlog       FDn   ecoDGE
## 203       Hooded Vulture Necrosyrtes_monachus          CR 0.4933096 0.4009949 0.5509619 1.073348
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find the ecoDGE score for Gypaetus barbatus.</span>
<span class="n">accip_ecoDGE</span><span class="p">[</span><span class="n">accip_ecoDGE</span><span class="o">$</span><span class="n">jetz_name</span> <span class="o">==</span> <span class="s">&quot;Gypaetus_barbatus&quot;</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="o">:</span><span class="m">3</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="m">27</span><span class="o">:</span><span class="m">30</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>##     birdlife_common_name         jetz_name redlist_cat       FD     FDlog FDn    ecoDGE
## 138      Bearded Vulture Gypaetus_barbatus          NT 1.002616 0.6944545   1 0.7784986
</pre></div>
</div>
<p>Yes! The Hooded Vulture is now our top conservation priority if we use
ecoDGE scores to inform our decisions. We can also look at the top
species.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the top 5% of ecoDGE scores.</span>
<span class="n">accip_ecoDGE</span><span class="p">[</span><span class="n">accip_ecoDGE</span><span class="o">$</span><span class="n">ecoDGE</span> <span class="o">&gt;</span> <span class="nf">quantile</span><span class="p">(</span><span class="n">accip_ecoDGE</span><span class="o">$</span><span class="n">ecoDGE</span><span class="p">,</span> <span class="m">0.95</span><span class="p">),</span> <span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="o">:</span><span class="m">3</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="m">27</span><span class="o">:</span><span class="m">30</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>##       birdlife_common_name               jetz_name redlist_cat        FD     FDlog       FDn    ecoDGE
## 105             Cuban Kite  Chondrohierax_wilsonii          CR 0.3470922 0.2979483 0.3932849 0.9703011
## 140   White-backed Vulture          Gyps_africanus          CR 0.2229335 0.2012525 0.2453255 0.8736052
## 141   White-rumped Vulture        Gyps_bengalensis          CR 0.1944576 0.1776922 0.2092747 0.8500450
## 145         Indian Vulture            Gyps_indicus          CR 0.1992261 0.1816764 0.2153712 0.8540292
## 146      Rüppell&#39;s Vulture         Gyps_rueppellii          CR 0.4414195 0.3656284 0.4968458 1.0379812
## 147 Slender-billed Vulture       Gyps_tenuirostris          CR 0.3275007 0.2832980 0.3708677 0.9556508
## 155  Madagascar Fish-eagle Haliaeetus_vociferoides          CR 0.2056280 0.1870006 0.2235180 0.8593534
## 203         Hooded Vulture    Necrosyrtes_monachus          CR 0.4933096 0.4009949 0.5509619 1.0733477
## 204       Egyptian Vulture   Neophron_percnopterus          EN 0.6344264 0.4912919 0.6891302 0.8274683
## 208      Flores Hawk-eagle         Nisaetus_floris          CR 0.4213525 0.3516089 0.4753938 1.0239617
## 217       Philippine Eagle   Pithecophaga_jefferyi          CR 0.3451327 0.2964927 0.3910576 0.9688454
## 222     Red-headed Vulture        Sarcogyps_calvus          CR 0.3733088 0.3172230 0.4227782 0.9895758
</pre></div>
</div>
<p>As we can see, nearly all of the highest ecoDGE scores are critically
endangered, which means we could soon lose their unique ecosystem
functions. The removal of enough of these species may even cause a
collapse in the current ecosystem, as species are unable to fill vital
niches. But is it right to focus on these species instead of our top
EDGE species? Could you argue a case for EDGE or ecoDGE as the top
priority of conservation?</p>
</section>
<section id="ecoedge-scores">
<h2>6. EcoEDGE Scores<a class="headerlink" href="#ecoedge-scores" title="Permalink to this headline">¶</a></h2>
<p>So we’ve used EDGE scores to combine extinction risk with evolutionary
diversity, and ecoDGE scores to do the same with functional diversity.
However, both are important, and we might want to combine all three into
one metric. This is exactly what EcoEDGE scores do (confusingly, their
creators decided to use very very similar names). And we’ve pretty much
done all the hard work already. The equation is similar to the ones
we’ve used, but we give ED and FD scores equal weighting:</p>
<div class="math notranslate nohighlight">
\[EcoEDGE= (0.5×EDn + 0.5×FDn) + GE×ln⁡(2)\]</div>
<p>And remember our EDn and FDn scores have already been logged, so we
don’t need to log them now.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge FD and ED scores.</span>
<span class="n">accip_EcoEDGE</span> <span class="o">&lt;-</span> <span class="nf">left_join</span><span class="p">(</span><span class="n">accip_EDGE</span><span class="p">,</span> <span class="n">accip_ecoDGE</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>## Joining, by = c(&quot;birdlife_name&quot;, &quot;birdlife_common_name&quot;, &quot;jetz_name&quot;, &quot;jetz_order&quot;, &quot;jetz_family&quot;, &quot;redlist_cat&quot;,
## &quot;extinct_prob&quot;, &quot;beak_length_culmen&quot;, &quot;beak_length_nares&quot;, &quot;beak_width&quot;, &quot;beak_depth&quot;, &quot;tarsus_length&quot;,
## &quot;wing_length&quot;, &quot;kipps_distance&quot;, &quot;secondary1&quot;, &quot;hand_wing_index&quot;, &quot;tail_length&quot;, &quot;mass&quot;, &quot;habitat_density&quot;,
## &quot;migration&quot;, &quot;trophic_level&quot;, &quot;trophic_niche&quot;, &quot;primary_lifestyle&quot;, &quot;centroid_latitude&quot;, &quot;centroid_longitude&quot;,
## &quot;range_size&quot;)
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate EcoEDGE scores.</span>
<span class="n">accip_EcoEDGE</span><span class="o">$</span><span class="n">EcoEDGE</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="m">0.5</span><span class="o">*</span><span class="n">accip_EcoEDGE</span><span class="o">$</span><span class="n">EDn</span> <span class="o">+</span> <span class="m">0.5</span><span class="o">*</span><span class="n">accip_EcoEDGE</span><span class="o">$</span><span class="n">FDn</span><span class="p">)</span> <span class="o">+</span> <span class="n">accip_EcoEDGE</span><span class="o">$</span><span class="n">extinct_prob</span><span class="o">*</span><span class="nf">log</span><span class="p">(</span><span class="m">2</span><span class="p">)</span>

<span class="c1"># Select just the relevant columns.</span>
<span class="n">accip_EcoEDGE</span> <span class="o">&lt;-</span> <span class="n">accip_EcoEDGE</span> <span class="o">%&gt;%</span> <span class="n">dplyr</span><span class="o">::</span><span class="nf">select</span><span class="p">(</span><span class="n">birdlife_common_name</span><span class="p">,</span> <span class="n">jetz_name</span><span class="p">,</span> 
                                                 <span class="n">redlist_cat</span><span class="p">,</span> <span class="n">extinct_prob</span><span class="p">,</span> <span class="n">EDGE</span><span class="p">,</span> <span class="n">ecoDGE</span><span class="p">,</span> <span class="n">EcoEDGE</span><span class="p">)</span>

<span class="c1"># Check it&#39;s worked.</span>
<span class="nf">head</span><span class="p">(</span><span class="n">accip_EcoEDGE</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>##      birdlife_common_name             jetz_name redlist_cat extinct_prob     EDGE     ecoDGE   EcoEDGE
## 1            Pied Goshawk Accipiter_albogularis          LC     0.060625 2.256493 0.09840419 0.3248673
## 2                  Shikra      Accipiter_badius          LC     0.060625 1.911028 0.35762600 0.4517345
## 3          Bicolored Hawk     Accipiter_bicolor          LC     0.060625 2.250052 0.17506057 0.3821830
## 4 New Britain Sparrowhawk  Accipiter_brachyurus          VU     0.242500 2.637361 0.35691370 0.6049670
## 5      Levant Sparrowhawk    Accipiter_brevipes          LC     0.060625 1.935681 0.15094486 0.2987070
## 6     Nicobar Sparrowhawk     Accipiter_butleri          VU     0.242500 2.671207 0.27494598 0.5492564
</pre></div>
</div>
<p>We can again look at the spread and see which are the highest species.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the highest scoring species.</span>
<span class="n">accip_EcoEDGE</span><span class="p">[</span><span class="n">accip_EcoEDGE</span><span class="o">$</span><span class="n">EcoEDGE</span> <span class="o">==</span> <span class="nf">max</span><span class="p">(</span><span class="n">accip_EcoEDGE</span><span class="o">$</span><span class="n">EcoEDGE</span><span class="p">),]</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>##     birdlife_common_name             jetz_name redlist_cat extinct_prob    EDGE    ecoDGE  EcoEDGE
## 217     Philippine Eagle Pithecophaga_jefferyi          CR         0.97 3.81352 0.9688454 1.330583
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the top 10% of EcoEDGE scores.</span>
<span class="n">accip_EcoEDGE</span><span class="p">[</span><span class="n">accip_EcoEDGE</span><span class="o">$</span><span class="n">EcoEDGE</span> <span class="o">&gt;</span> <span class="nf">quantile</span><span class="p">(</span><span class="n">accip_EcoEDGE</span><span class="o">$</span><span class="n">EcoEDGE</span><span class="p">,</span> <span class="m">0.9</span><span class="p">),]</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>##         birdlife_common_name               jetz_name redlist_cat extinct_prob     EDGE    ecoDGE   EcoEDGE
## 92            Ridgway&#39;s Hawk          Buteo_ridgwayi          CR     0.970000 2.212389 0.7982755 0.8688990
## 103      Scissor-tailed Kite   Chelictinia_riocourii          LC     0.060625 3.363513 0.6704771 0.9915274
## 105               Cuban Kite  Chondrohierax_wilsonii          CR     0.970000 3.126552 0.9703011 1.1896011
## 127      Swallow-tailed Kite    Elanoides_forficatus          LC     0.060625 3.337099 0.4913643 0.8490288
## 134 Madagascar Serpent-eagle       Eutriorchis_astur          EN     0.485000 3.609771 0.4560870 0.8866993
## 138          Bearded Vulture       Gypaetus_barbatus          NT     0.121250 3.273313 0.7784986 1.0566946
## 140     White-backed Vulture          Gyps_africanus          CR     0.970000 2.609136 0.8736052 1.0085969
## 141     White-rumped Vulture        Gyps_bengalensis          CR     0.970000 2.463403 0.8500450 0.9604275
## 145           Indian Vulture            Gyps_indicus          CR     0.970000 2.250380 0.8540292 0.9194131
## 146        Rüppell&#39;s Vulture         Gyps_rueppellii          CR     0.970000 2.268981 1.0379812 1.0639978
## 147   Slender-billed Vulture       Gyps_tenuirostris          CR     0.970000 2.250356 0.9556508 0.9971565
## 151      Pallas&#39;s Fish-eagle  Haliaeetus_leucoryphus          EN     0.485000 2.601584 0.5406144 0.7428318
## 152      Steller&#39;s Sea-eagle    Haliaeetus_pelagicus          VU     0.242500 2.413923 0.6905559 0.8140119
## 155    Madagascar Fish-eagle Haliaeetus_vociferoides          CR     0.970000 2.751669 0.8593534 1.0271751
## 161              Harpy Eagle          Harpia_harpyja          NT     0.121250 3.208049 0.5340403 0.8561659
## 164             Papuan Eagle Harpyopsis_novaeguineae          VU     0.242500 3.400970 0.3586585 0.7642498
## 202            Crested Eagle     Morphnus_guianensis          NT     0.121250 3.208049 0.4151559 0.7652102
## 203           Hooded Vulture    Necrosyrtes_monachus          CR     0.970000 3.287320 1.0733477 1.3016934
## 204         Egyptian Vulture   Neophron_percnopterus          EN     0.485000 3.525445 0.8274683 1.1533920
## 208        Flores Hawk-eagle         Nisaetus_floris          CR     0.970000 2.520177 1.0239617 1.1052303
## 217         Philippine Eagle   Pithecophaga_jefferyi          CR     0.970000 3.813520 0.9688454 1.3305826
## 222       Red-headed Vulture        Sarcogyps_calvus          CR     0.970000 3.284243 0.9895758 1.2369650
## 235     Lappet-faced Vulture     Torgos_tracheliotos          EN     0.485000 2.589196 0.7609423 0.9088369
## 236     White-headed Vulture Trigonoceps_occipitalis          CR     0.970000 3.045750 0.8062256 1.0473573
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># See the spread.</span>
<span class="nf">hist</span><span class="p">(</span><span class="n">accip_EcoEDGE</span><span class="o">$</span><span class="n">EcoEDGE</span><span class="p">,</span> <span class="n">breaks</span> <span class="o">=</span> <span class="m">20</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/unnamed-chunk-33-1.png"><img alt="../../_images/unnamed-chunk-33-1.png" class="align-center" src="../../_images/unnamed-chunk-33-1.png" style="width: 600px;" /></a>
<p>So when combining EDGE and ecoDGE, the Philippine Eagle is the highest
species. In general, we might expect ED and FD to correlate, as species
with many close relatives are likely to share morphological traits that
determine function. For your own taxa, you might find that these scores
match up, or perhaps there are different conservation priorities for
each metric. Because we don’t tend to focus on conserving a single
species, there should be differences between each metric that make
deciding conservation priorities a complicated task. How you chose to
interpret and present your results is up to you, and will depend on the
group that you’ve chosen.</p>
<p>For the practicals and coursework we’ve chosen to use a simplified
version of EcoEDGE scores. If you’re interested in learning more, check
out this paper which first proposed the use of EcoEDGE scores:</p>
<p><a class="reference external" href="https://onlinelibrary.wiley.com/doi/full/10.1111/ddi.12320">https://onlinelibrary.wiley.com/doi/full/10.1111/ddi.12320</a></p>
</section>
<section id="plotting-a-map-of-iucn-categories">
<h2>7. Plotting a map of IUCN categories<a class="headerlink" href="#plotting-a-map-of-iucn-categories" title="Permalink to this headline">¶</a></h2>
<p>You may wish to plot maps of your IUCN redlist categories, especially if
you’re interested in what areas of the world are most threatened by
extinction. We can do this easily using similar code from practical 3.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># First load in the spatial packages we&#39;ll need.</span>
<span class="nf">library</span><span class="p">(</span><span class="n">raster</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">fasterize</span><span class="p">)</span>

<span class="c1"># Load the data into our environment.</span>
<span class="nf">load</span><span class="p">(</span><span class="s">&quot;data/accipitridae_ranges.RData&quot;</span><span class="p">)</span>

<span class="c1"># Inspect the maps.</span>
<span class="nf">class</span><span class="p">(</span><span class="n">accip_ranges</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>## [1] &quot;sf&quot;         &quot;data.frame&quot;
</pre></div>
</div>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">head</span><span class="p">(</span><span class="n">accip_ranges</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>## Simple feature collection with 6 features and 3 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: -17.53522 ymin: -29.47375 xmax: 167.2831 ymax: 55.85556
## Geodetic CRS:  WGS 84
##             ID               SCINAME DATE_                          Shape
## 10764 22695535 Accipiter_albogularis  2014 MULTIPOLYGON (((167.2819 -9...
## 1     22695490      Accipiter_badius  2013 MULTIPOLYGON (((-17.4704 14...
## 14087 22695605  Accipiter_brachyurus  2018 MULTIPOLYGON (((152.9669 -4...
## 13013 22695499    Accipiter_brevipes  2009 MULTIPOLYGON (((19.3891 39....
## 10777 22695494     Accipiter_butleri  2014 MULTIPOLYGON (((93.531 8.01...
## 6618  22695486 Accipiter_castanilius  2013 MULTIPOLYGON (((7.090881 6....
</pre></div>
</div>
<p>We’ll run the same code as before to compile our spatial dataframe into
a single raster layer. The only difference is this time we’re assigning
values based on GE rating rather than range size.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Combine the two datasets into one object. (This turns our maps into a normal dataframe)</span>
<span class="n">accip_ranges</span> <span class="o">&lt;-</span> <span class="nf">left_join</span><span class="p">(</span><span class="n">accip_EcoEDGE</span><span class="p">,</span> <span class="n">accip_ranges</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;jetz_name&quot;</span> <span class="o">=</span> <span class="s">&quot;SCINAME&quot;</span><span class="p">))</span>

<span class="c1"># Create an empty raster stack to store our data in.</span>
<span class="n">raster_template</span> <span class="o">&lt;-</span> <span class="nf">raster</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="m">2160</span><span class="p">,</span> <span class="n">nrows</span> <span class="o">=</span> <span class="m">900</span><span class="p">,</span> <span class="n">ymn</span> <span class="o">=</span> <span class="m">-60</span><span class="p">)</span>

<span class="c1"># &#39;fasterize&#39; needs objects to be an sf class so we&#39;ll convert it back into an sf dataframe.</span>
<span class="n">accip_ranges</span> <span class="o">&lt;-</span> <span class="nf">st_sf</span><span class="p">(</span><span class="n">accip_ranges</span><span class="p">)</span>

<span class="c1"># Use the fasterize function with the raster template. </span>
<span class="c1"># We want to use the GE field, and the function max takes the highest value when they overlap.</span>
<span class="n">GE_raster</span> <span class="o">&lt;-</span> <span class="nf">fasterize</span><span class="p">(</span><span class="n">accip_ranges</span><span class="p">,</span> <span class="n">raster_template</span><span class="p">,</span> <span class="n">field</span> <span class="o">=</span> <span class="s">&quot;extinct_prob&quot;</span><span class="p">,</span> <span class="n">fun</span> <span class="o">=</span> <span class="s">&quot;max&quot;</span><span class="p">)</span>

<span class="c1"># Plot the new map. Colour ramp palette is another way to make a palette.</span>
<span class="c1"># The second brackets (50) is the number of colours to create from the function.</span>
<span class="n">green_to_red</span> <span class="o">&lt;-</span> <span class="nf">colorRampPalette</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;forestgreen&quot;</span><span class="p">,</span> <span class="s">&quot;khaki&quot;</span><span class="p">,</span> <span class="s">&quot;firebrick&quot;</span><span class="p">))(</span><span class="m">20</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="nf">as.factor</span><span class="p">(</span><span class="n">GE_raster</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="n">green_to_red</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/unnamed-chunk-35-1.png"><img alt="../../_images/unnamed-chunk-35-1.png" class="align-center" src="../../_images/unnamed-chunk-35-1.png" style="width: 600px;" /></a>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can use <code class="docutils literal notranslate"><span class="pre">colors()</span></code> to see the list of all the named colours to play with.</p>
</div>
<p>Now we’ve created our stack of range maps, and each are coded for their
IUCN category. In this case we’ll take the maximum GE score as the one
that’s shown. So if two ranges overlap, we take the highest score.</p>
<p>So now you can see the spread of GE scores throughout the globe. For
your own species you may wish to focus on a specific area of Earth using
the <code class="docutils literal notranslate"><span class="pre">crop()</span></code> function. Again we’ll use ggplot2 to make them a little
nicer to look at.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">tidyr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="c1"># Convert the raster into a raster dataframe. </span>
<span class="c1"># Remove rows with NA values from this dataframe.</span>
<span class="n">raster_data</span> <span class="o">&lt;-</span> <span class="nf">as.data.frame</span><span class="p">(</span><span class="n">GE_raster</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">drop_na</span><span class="p">()</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">raster_data</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;long&quot;</span><span class="p">,</span> <span class="s">&quot;lat&quot;</span><span class="p">,</span> <span class="s">&quot;index&quot;</span><span class="p">)</span>

<span class="c1"># Turn the GE score values to a factor to give a discrete raster rather than continuous values.</span>
<span class="n">raster_data</span><span class="o">$</span><span class="n">index</span> <span class="o">&lt;-</span> <span class="nf">as.factor</span><span class="p">(</span><span class="n">raster_data</span><span class="o">$</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># we can then plot this in ggplot. We have to first create the colour scheme for our map.</span>
<span class="c1"># The six character codes (hexcodes) signify a colour. There are many stock colours </span>
<span class="c1"># (i.e. &quot;grey80&quot; yellow&quot; &quot;orange&quot; &quot;red&quot;) but hexcodes give more flexibility.</span>
<span class="c1"># Find colour hexcodes here: https://www.rapidtables.com/web/color/RGB_Color.html</span>
<span class="n">myColors</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;grey80&quot;</span><span class="p">,</span> <span class="s">&quot;grey80&quot;</span><span class="p">,</span> <span class="s">&quot;#FCF7B7&quot;</span><span class="p">,</span> <span class="s">&quot;#FFD384&quot;</span><span class="p">,</span> <span class="s">&quot;#FFA9A9&quot;</span><span class="p">)</span>

<span class="c1"># Assign names to these colours that correspond to each GE score. </span>
<span class="c1"># We also use the sort() function to make sure the numbers are in ascending order.</span>
<span class="nf">names</span><span class="p">(</span><span class="n">myColors</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nf">unique</span><span class="p">(</span><span class="nf">sort</span><span class="p">(</span><span class="n">raster_data</span><span class="o">$</span><span class="n">index</span><span class="p">))</span>

<span class="c1"># Create the colour scale.</span>
<span class="n">colScale</span> <span class="o">&lt;-</span> <span class="nf">scale_fill_manual</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Extinction\nProbability&quot;</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="n">myColors</span><span class="p">)</span>

<span class="c1"># Create a plot with ggplot (the plus signs at the end of a line carry over to the next line).</span>
<span class="n">GE_plot</span> <span class="o">&lt;-</span> <span class="nf">ggplot</span><span class="p">()</span> <span class="o">+</span>
  
  <span class="c1"># Add the borders again.</span>
  <span class="nf">borders</span><span class="p">(</span><span class="n">ylim</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">-60</span><span class="p">,</span><span class="m">90</span><span class="p">),</span> <span class="n">fill</span> <span class="o">=</span> <span class="s">&quot;grey90&quot;</span><span class="p">,</span> <span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;grey90&quot;</span><span class="p">)</span> <span class="o">+</span>
  
  <span class="c1"># We need to reset the xlim to -180/180 again.</span>
  <span class="nf">xlim</span><span class="p">(</span><span class="m">-180</span><span class="p">,</span> <span class="m">180</span><span class="p">)</span> <span class="o">+</span>

  <span class="c1"># Add the GE information on top.</span>
  <span class="nf">geom_tile</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">long</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">lat</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">index</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">raster_data</span><span class="p">)</span> <span class="o">+</span>
  
  <span class="c1"># Add the formatting again!</span>
  <span class="n">colScale</span> <span class="o">+</span>
  <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Accipitridae Threat Map&quot;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">theme_classic</span><span class="p">()</span> <span class="o">+</span>
  <span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;Latitude&quot;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;Longitude&quot;</span><span class="p">)</span> <span class="o">+</span> 
  <span class="nf">coord_fixed</span><span class="p">()</span>

<span class="c1"># Resize the plotting window and return the plot so we can view it.</span>
<span class="nf">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">15</span><span class="p">,</span> <span class="n">repr.plot.height</span><span class="o">=</span><span class="m">10</span><span class="p">)</span>
<span class="n">GE_plot</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/unnamed-chunk-37-1.png"><img alt="../../_images/unnamed-chunk-37-1.png" class="align-center" src="../../_images/unnamed-chunk-37-1.png" style="width: 600px;" /></a>
<p>There’s our finished map! Think how you’d change it yourself if you want
to include one in your report. It’s up to you and what you think is the
best way to visualise your data!</p>
<blockquote>
<div><p>Extra task: Do you think this is a good way to show the data? What
would you do differently? Could you use another metric from today’s
practical like EDGE? And is taking the highest score when cells
overlap the best option? Instead try and create an average extinction
probability raster.</p>
</div></blockquote>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Fasterize doesn’t have a mean function option, but we can get around this by dividing one raster by another.
We first need to sum all the extinction probabilities, and then divide by species richness. Look back at
<a class="reference external" href="https://syrph.github.io/BCB_2022/markdowns/practical_1/practical_1.html#plotting-maps">Practical 1</a> for a reminder of how to create a species richness raster. Then it’s as easy as:</p>
<p><code class="docutils literal notranslate"><span class="pre">average_raster</span> <span class="pre">&lt;-</span> <span class="pre">sum_raster</span> <span class="pre">/</span> <span class="pre">richness_raster</span></code></p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Show the answer…  </p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Sum all the extinction probabilities.</span>
<span class="n">sum_raster</span> <span class="o">&lt;-</span> <span class="nf">fasterize</span><span class="p">(</span><span class="n">accip_ranges</span><span class="p">,</span> <span class="n">raster_template</span><span class="p">,</span> <span class="n">field</span> <span class="o">=</span> <span class="s">&quot;extinct_prob&quot;</span><span class="p">,</span> <span class="n">fun</span> <span class="o">=</span> <span class="s">&quot;sum&quot;</span><span class="p">)</span>

<span class="c1"># Use the sum function with no field for richness. (Assumes each range = 1).</span>
<span class="n">richness_raster</span> <span class="o">&lt;-</span> <span class="nf">fasterize</span><span class="p">(</span><span class="n">accip_ranges</span><span class="p">,</span> <span class="n">raster_template</span><span class="p">,</span> <span class="n">fun</span> <span class="o">=</span> <span class="s">&quot;sum&quot;</span><span class="p">)</span>

<span class="c1"># Divide the total by number of species to get average.</span>
<span class="n">average_raster</span> <span class="o">&lt;-</span> <span class="n">sum_raster</span> <span class="o">/</span> <span class="n">richness_raster</span>

<span class="c1"># Plot the new map.</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">average_raster</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/unnamed-chunk-39-11.png"><img alt="../../_images/unnamed-chunk-39-11.png" class="align-center" src="../../_images/unnamed-chunk-39-11.png" style="width: 600px;" /></a>
<p>In this case we can see that the two maps are actually quite similar. If
we look close enough we can see there are some cells that have a higher
extinction risk (like in southern Spain), but there are so few we’d
probably call them outliers. This stretches out our colour scale, and
makes it hard to determine relative patterns for the rest of the world.
We can instead take logs, which reduces the effect of outliers.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the map after logging cell values.</span>
<span class="nf">plot</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">average_raster</span><span class="p">),</span> <span class="n">col</span> <span class="o">=</span> <span class="n">green_to_red</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/unnamed-chunk-40-11.png"><img alt="../../_images/unnamed-chunk-40-11.png" class="align-center" src="../../_images/unnamed-chunk-40-11.png" style="width: 600px;" /></a>
<p>Now we can see the pattern clearer. For your coursework, experiment with
different metrics and methods to produce the best looking and most
informative maps. Lastly we can redo the maps with ggplot, and rescale
the values so that it’s relative extinction risk (not probability).</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># With GGplot. </span>
<span class="n">raster_data</span> <span class="o">&lt;-</span> <span class="nf">as.data.frame</span><span class="p">(</span><span class="n">average_raster</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">drop_na</span><span class="p">()</span>
<span class="nf">colnames</span><span class="p">(</span><span class="n">raster_data</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="nf">c</span><span class="p">(</span><span class="s">&quot;long&quot;</span><span class="p">,</span> <span class="s">&quot;lat&quot;</span><span class="p">,</span> <span class="s">&quot;index&quot;</span><span class="p">)</span>

<span class="c1"># We&#39;ll log the values, and then rescale from 0 to 1 so it&#39;s relative probabilities.</span>
<span class="n">raster_data</span><span class="o">$</span><span class="n">index</span> <span class="o">&lt;-</span> <span class="nf">log</span><span class="p">(</span><span class="n">raster_data</span><span class="o">$</span><span class="n">index</span><span class="p">)</span>
<span class="n">raster_data</span><span class="o">$</span><span class="n">index</span> <span class="o">&lt;-</span> <span class="n">scales</span><span class="o">::</span><span class="nf">rescale</span><span class="p">(</span><span class="n">raster_data</span><span class="o">$</span><span class="n">index</span><span class="p">,</span>  <span class="n">to</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">))</span>

<span class="nf">ggplot</span><span class="p">()</span> <span class="o">+</span>
  
  <span class="c1"># Add the borders again.</span>
  <span class="nf">borders</span><span class="p">(</span><span class="n">ylim</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">-60</span><span class="p">,</span><span class="m">90</span><span class="p">),</span> <span class="n">fill</span> <span class="o">=</span> <span class="s">&quot;grey90&quot;</span><span class="p">,</span> <span class="n">colour</span> <span class="o">=</span> <span class="s">&quot;grey90&quot;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">xlim</span><span class="p">(</span><span class="m">-180</span><span class="p">,</span> <span class="m">180</span><span class="p">)</span> <span class="o">+</span>

  <span class="c1"># Add the GE information on top.</span>
  <span class="nf">geom_tile</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">long</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">lat</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="n">index</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">raster_data</span><span class="p">)</span> <span class="o">+</span>
  
  <span class="c1"># Add the formatting again!</span>
  <span class="c1"># Add a continuous colour scheme in ggplot.</span>
  <span class="nf">scale_fill_gradientn</span><span class="p">(</span><span class="n">colours</span> <span class="o">=</span> <span class="n">green_to_red</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Relative\nExtinction\nRisk&quot;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Accipitridae Threat Map&quot;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">theme_classic</span><span class="p">()</span> <span class="o">+</span>
  <span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;Latitude&quot;</span><span class="p">)</span> <span class="o">+</span>
  <span class="nf">xlab</span><span class="p">(</span><span class="s">&quot;Longitude&quot;</span><span class="p">)</span> <span class="o">+</span> 
  <span class="nf">coord_fixed</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/unnamed-chunk-41-11.png"><img alt="../../_images/unnamed-chunk-41-11.png" class="align-center" src="../../_images/unnamed-chunk-41-11.png" style="width: 600px;" /></a>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./markdowns/practical_3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../practical_2/practical_2.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Macroecology analyses</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../../links.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Useful links</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>